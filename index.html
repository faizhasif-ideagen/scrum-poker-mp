<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Story Point Knights Team Battle</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <!-- Login Mode Selection Screen -->
        <div id="loginScreen" class="screen active">
            <h1>Story Point Knights Team Battle</h1>
            <div class="login-container">
                <div class="login-option">
                    <button id="networkLoginBtn" class="mode-btn network-btn">
                        <span class="btn-icon">üåê</span>
                        <span class="btn-title">Network Play</span>
                        <span class="btn-desc">Multiple players login from different devices</span>
                    </button>
                </div>
                <div class="login-option">
                    <button id="localPlayBtn" class="mode-btn local-btn">
                        <span class="btn-icon">üéÆ</span>
                        <span class="btn-title">Local Play</span>
                        <span class="btn-desc">Single device with saved players</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Network Login Screen -->
        <div id="networkLoginScreen" class="screen">
            <h1>üåê Network Login</h1>
            <div class="network-login-container">
                <div class="network-info">
                    <p class="network-status">üü¢ Server Ready</p>
                    <p class="network-url">Session URL: <strong>http://game.local/session/ABC123</strong></p>
                    <p class="network-instruction">Share this URL with other players to join!</p>
                </div>
                <div class="logged-in-players">
                    <h3>Logged In Players</h3>
                    <div id="networkPlayersList" class="network-players-list">
                        <p class="waiting-message">Waiting for players to connect...</p>
                    </div>
                </div>
                <div class="network-actions">
                    <button id="mockLoginBtn" class="action-btn">+ Mock Player Login (Demo)</button>
                    <button id="networkContinueBtn" class="start-btn" disabled>Continue to Game ‚Üí</button>
                    <button id="backToLoginBtn" class="back-btn">‚Üê Back</button>
                </div>
            </div>
        </div>

        <!-- Story Estimation Screen -->
        <div id="estimationScreen" class="screen">
            <h1>üìù Story Point Estimator</h1>
            <div class="estimation-container">
                <div class="estimation-input-section">
                    <h2>Describe Your Task</h2>
                    <p class="helper-text">Paste or type your user story, task description, or feature requirements below. Our AI will analyze the complexity and recommend story points!</p>
                    <textarea id="taskDescription" placeholder="Example: As a user, I want to be able to reset my password so that I can regain access to my account if I forget it. This includes email verification, secure token generation, and password validation..."></textarea>
                    <button id="analyzeBtn" class="analyze-btn">ü§ñ Analyze with AI</button>
                </div>
                <div class="estimation-results">
                    <h2>AI Recommendations</h2>
                    <div id="analysisResults" class="analysis-results">
                        <div class="waiting-message">
                            <span class="ai-icon">ü§ñ</span>
                            <p>Enter a task description and click "Analyze with AI" to get story point recommendations!</p>
                        </div>
                    </div>
                </div>
            </div>
            <button id="proceedToSetupBtn" class="start-btn">Continue to Team Setup ‚Üí</button>
        </div>

        <!-- Setup Screen -->
        <div id="setupScreen" class="screen">
            <h1>Story Point Knights Team Battle</h1>
            <div class="setup-container">
                <div class="player-input-section">
                    <h2>Add Players (Max 20)</h2>
                    <div class="input-group">
                        <input type="text" id="playerName" placeholder="Enter player name" maxlength="20">
                        <select id="fibonacciNumber">
                            <option value="">Select Story Points</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="5">5</option>
                            <option value="8">8</option>
                            <option value="13">13</option>
                            <option value="21">21</option>
                            <option value="34">34</option>
                            <option value="55">55</option>
                            <option value="89">89</option>
                        </select>
                        <button id="addPlayerBtn">Add Player</button>
                    </div>
                    <div id="playersList" class="players-list"></div>
                </div>
                <div class="instructions">
                    <h3>How to Play</h3>
                    <ul>
                        <li>Add 2-20 players with story point values</li>
                        <li>Players with same story points = SAME TEAM</li>
                        <li>Teams: Red vs Cyan (based on story points)</li>
                        <li>ALL players spawn randomly on the battlefield!</li>
                        <li>You control first knight (Arrow Keys/WASD + Q/E + SPACE)</li>
                        <li>AI controls the rest automatically</li>
                        <li>Attacks are DIRECTIONAL - face your target!</li>
                        <li>Use Q/E to rotate and aim your attacks</li>
                        <li>Press C to BLOCK attacks from your front!</li>
                        <li>Sword swipes deal damage mid-swing</li>
                        <li>Random attack ranges (40-78 pixels)</li>
                        <li>Same team CANNOT attack each other</li>
                        <li>Last team standing wins!</li>
                    </ul>
                    <div id="startError" class="start-error"></div>
                    <button id="startTournamentBtn" class="start-btn" disabled>Start Battle</button>
                    <button id="finishRoundBtn" class="finish-btn">Finish Round & View Rankings ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Rankings Screen -->
        <div id="rankingsScreen" class="screen">
            <h1>üìä Rankings & Statistics</h1>
            <div class="rankings-container">
                <div class="top-scorer-section">
                    <h2>üèÜ Top Scorer</h2>
                    <div id="topScorer" class="top-scorer-display"></div>
                </div>
                <div class="rankings-table-section">
                    <h2>Player Rankings</h2>
                    <table id="rankingsTable" class="rankings-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Player</th>
                                <th>Story Points</th>
                                <th>Games</th>
                                <th>Wins</th>
                                <th>Kills</th>
                                <th>Damage</th>
                                <th>Score</th>
                            </tr>
                        </thead>
                        <tbody id="rankingsTableBody">
                        </tbody>
                    </table>
                    <p style="text-align: center; margin-top: 20px; color: rgba(255,255,255,0.7); font-size: 14px;">
                        * Stats are cumulative across all battles. Score = (Kills √ó 10) + (Wins √ó 50) + (Damage √∑ 10)
                    </p>
                </div>
                <div class="rankings-actions">
                    <button id="backToSetupBtn" class="start-btn">‚Üê Back to Setup</button>
                    <button id="resetStatsBtn" class="reset-btn">Reset Statistics Only</button>
                    <button id="clearAllDataBtn" class="reset-btn" style="background: rgba(139, 0, 0, 0.3); border-color: #8B0000;">Clear All Data & Players</button>
                </div>
            </div>
        </div>

        <!-- Battle Screen -->
        <div id="battleScreen" class="screen">
            <div class="battle-hud">
                <div id="currentMatch" class="current-match"></div>
                <div id="battleTimer" class="battle-timer">Time: 0s</div>
            </div>
            <canvas id="gameCanvas"></canvas>
            <div id="battleLog" class="battle-log"></div>
            <div class="controls-hint">
                <span>Move: ‚Üë‚Üì‚Üê‚Üí or WASD</span>
                <span>Rotate: Q/E</span>
                <span>Block: C</span>
                <span>Attack: SPACE</span>
            </div>
        </div>

        <!-- Winner Screen -->
        <div id="winnerScreen" class="screen">
            <h1>üèÜ Victory! üèÜ</h1>
            <div id="winnerDisplay" class="winner-display"></div>
            <div class="winner-actions">
                <button id="editPointsBtn" class="edit-btn">‚úèÔ∏è Edit Story Points</button>
                <button id="nextBattleBtn" class="start-btn">Next Battle ‚Üí</button>
                <button id="viewRankingsBtn" class="start-btn">View Rankings ‚Üí</button>
                <button id="newTournamentBtn" class="back-btn">‚Üê Back to Start</button>
            </div>
        </div>
    </div>

    <script src="game.js"></script>
</body>
</html>
